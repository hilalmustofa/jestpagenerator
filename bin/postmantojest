#!/usr/bin/env node
const fs = require('fs');
const path = require('path');
const { execSync } = require('child_process');
const inquirer = require('inquirer');

const asciiLogo = `

‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà  ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñÑ ‚ñÑ‚ñà‚ñà‚ñà‚ñì‚ñÑ‚ñÑ‚ñÑ      ‚ñà‚ñà‚ñà‚ñÑ    ‚ñà    ‚ñÑ‚ñÑ‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñÑ‚ñÑ‚ñÑ‚ñà‚ñà‚ñÄ‚ñÄ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì
‚ñì‚ñà‚ñà‚ñë  ‚ñà‚ñà‚ñí‚ñà‚ñà‚ñí  ‚ñà‚ñà‚ñí‚ñà‚ñà    ‚ñí‚ñì  ‚ñà‚ñà‚ñí ‚ñì‚ñì‚ñà‚ñà‚ñí‚ñÄ‚ñà‚ñÄ ‚ñà‚ñà‚ñí‚ñà‚ñà‚ñà‚ñà‚ñÑ    ‚ñà‚ñà ‚ñÄ‚ñà   ‚ñà    ‚ñì  ‚ñà‚ñà‚ñí ‚ñì‚ñí‚ñà‚ñà‚ñí  ‚ñà‚ñà‚ñí      ‚ñí‚ñà‚ñà  ‚ñì‚ñà   ‚ñÄ‚ñí‚ñà‚ñà    ‚ñí‚ñì  ‚ñà‚ñà‚ñí ‚ñì‚ñí
‚ñì‚ñà‚ñà‚ñë ‚ñà‚ñà‚ñì‚ñí‚ñà‚ñà‚ñë  ‚ñà‚ñà‚ñë ‚ñì‚ñà‚ñà‚ñÑ  ‚ñí ‚ñì‚ñà‚ñà‚ñë ‚ñí‚ñì‚ñà‚ñà    ‚ñì‚ñà‚ñà‚ñí‚ñà‚ñà  ‚ñÄ‚ñà‚ñÑ ‚ñì‚ñà‚ñà  ‚ñÄ‚ñà ‚ñà‚ñà‚ñí   ‚ñí ‚ñì‚ñà‚ñà‚ñë ‚ñí‚ñí‚ñà‚ñà‚ñë  ‚ñà‚ñà‚ñí      ‚ñë‚ñà‚ñà  ‚ñí‚ñà‚ñà‚ñà  ‚ñë ‚ñì‚ñà‚ñà‚ñÑ  ‚ñí ‚ñì‚ñà‚ñà‚ñë ‚ñí‚ñë
‚ñí‚ñà‚ñà‚ñÑ‚ñà‚ñì‚ñí ‚ñí‚ñà‚ñà   ‚ñà‚ñà‚ñë ‚ñí   ‚ñà‚ñà‚ñë ‚ñì‚ñà‚ñà‚ñì ‚ñë‚ñí‚ñà‚ñà    ‚ñí‚ñà‚ñà‚ñë‚ñà‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñà‚ñà‚ñì‚ñà‚ñà‚ñí  ‚ñê‚ñå‚ñà‚ñà‚ñí   ‚ñë ‚ñì‚ñà‚ñà‚ñì ‚ñë‚ñí‚ñà‚ñà   ‚ñà‚ñà‚ñë   ‚ñì‚ñà‚ñà‚ñÑ‚ñà‚ñà‚ñì ‚ñí‚ñì‚ñà  ‚ñÑ  ‚ñí   ‚ñà‚ñà‚ñë ‚ñì‚ñà‚ñà‚ñì ‚ñë 
‚ñí‚ñà‚ñà‚ñí ‚ñë  ‚ñë ‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí ‚ñí‚ñà‚ñà‚ñí ‚ñë‚ñí‚ñà‚ñà‚ñí   ‚ñë‚ñà‚ñà‚ñí‚ñì‚ñà   ‚ñì‚ñà‚ñà‚ñí‚ñà‚ñà‚ñë   ‚ñì‚ñà‚ñà‚ñë     ‚ñí‚ñà‚ñà‚ñí ‚ñë‚ñë ‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñë    ‚ñì‚ñà‚ñà‚ñà‚ñí  ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí ‚ñí‚ñà‚ñà‚ñí ‚ñë 
‚ñí‚ñì‚ñí‚ñë ‚ñë  ‚ñë ‚ñí‚ñë‚ñí‚ñë‚ñí‚ñë‚ñí ‚ñí‚ñì‚ñí ‚ñí ‚ñë ‚ñí ‚ñë‚ñë  ‚ñë ‚ñí‚ñë   ‚ñë  ‚ñë‚ñí‚ñí   ‚ñì‚ñí‚ñà‚ñë ‚ñí‚ñë   ‚ñí ‚ñí      ‚ñí ‚ñë‚ñë  ‚ñë ‚ñí‚ñë‚ñí‚ñë‚ñí‚ñë     ‚ñí‚ñì‚ñí‚ñí‚ñë  ‚ñë‚ñë ‚ñí‚ñë ‚ñí ‚ñí‚ñì‚ñí ‚ñí ‚ñë ‚ñí ‚ñë‚ñë   
‚ñë‚ñí ‚ñë      ‚ñë ‚ñí ‚ñí‚ñë‚ñë ‚ñë‚ñí  ‚ñë ‚ñë   ‚ñë   ‚ñë  ‚ñë      ‚ñë ‚ñí   ‚ñí‚ñí ‚ñë ‚ñë‚ñë   ‚ñë ‚ñí‚ñë       ‚ñë     ‚ñë ‚ñí ‚ñí‚ñë     ‚ñí ‚ñë‚ñí‚ñë   ‚ñë ‚ñë  ‚ñë ‚ñë‚ñí  ‚ñë ‚ñë   ‚ñë    
‚ñë‚ñë      ‚ñë ‚ñë ‚ñë ‚ñí ‚ñë  ‚ñë  ‚ñë   ‚ñë     ‚ñë      ‚ñë    ‚ñë   ‚ñí     ‚ñë   ‚ñë ‚ñë      ‚ñë     ‚ñë ‚ñë ‚ñë ‚ñí      ‚ñë ‚ñë ‚ñë     ‚ñë  ‚ñë  ‚ñë  ‚ñë   ‚ñë      
            ‚ñë ‚ñë       ‚ñë                ‚ñë        ‚ñë  ‚ñë        ‚ñë                ‚ñë ‚ñë      ‚ñë   ‚ñë     ‚ñë  ‚ñë     ‚ñë          
                                                                                                                    
`;

const scriptPath = path.join(__dirname, '..', 'lib', 'postmantojest.js');

const jsonDataPath = path.resolve(process.cwd(), process.argv[2]);


function typeWriter(text, index, callback) {
  if (index < text.length) {
    process.stdout.write(text.charAt(index));
    setTimeout(() => {
      typeWriter(text, index + 1, callback);
    }, 50);
  } else {
    setTimeout(callback, 100);
  }
}

setTimeout(() => {
  console.log(asciiLogo);
  typeWriter('by Hilal Mustofa', 0, () => {
    if (!jsonDataPath) {
      console.error('Please provide the correct path for the .json file.');
      process.exit(1);
    }

    if (!fs.existsSync(jsonDataPath)) {
      console.error(`The file ${jsonDataPath} does not exist.`);
      process.exit(1);
    }

    const questions = [
      {
        type: 'list',
        name: 'language',
        message: 'Choose a language:',
        choices: ['JavaScript', 'TypeScript'],
      },
    ];

    inquirer.prompt(questions).then((answers) => {
      const language = answers.language.toLowerCase();

      try {
        setTimeout(() => {
          execSync(`node ${scriptPath} "${jsonDataPath}" ${language}`, {
            stdio: 'inherit',
          });
          const loadingInterval = setInterval(() => {
            process.stdout.write('\u001b[2K\u001b[0G‚è≥ Converting...');
          }, 20);

          setTimeout(() => {
            clearInterval(loadingInterval);
            console.log(
              '\u001b[2K\u001b[0G\u001b[32müí™Completed!\u001b[0m'
            );
          }, 2000);
        }, 500);
      } catch (error) {
        console.error(
          '\u001b[2K\u001b[0G\u001b[31m‚úò Error:\u001b[0m An error occurred while executing the script:',
          error.message
        );
        process.exit(1);
      }
    });
  });
}, 100);
