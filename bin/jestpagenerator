#!/usr/bin/env node
const fs = require('fs');
const path = require('path');
const { execSync } = require('child_process');

const scriptPath = path.join(__dirname, '..', 'lib', 'jestpagenerator.js'); 
const jsonDataPath = process.argv[2];

if (!jsonDataPath) {
  console.error('Please provide the correct path for the .json file.');
  process.exit(1);
}

if (!fs.existsSync(jsonDataPath)) {
  console.error(`The file ${jsonDataPath} does not exist.`);
  process.exit(1);
}

try {
  execSync(`node ${scriptPath} ${jsonDataPath}`, { stdio: 'inherit' });
  const loadingInterval = setInterval(() => {
    process.stdout.write('\u001b[2K\u001b[0G⬤  Converting...'); 
  }, 200);

  setTimeout(() => {
    clearInterval(loadingInterval);
    console.log('\u001b[2K\u001b[0G\u001b[32m✔ Completed!\u001b[0m'); 
  }, 2000);
} catch (error) {
  console.error('\u001b[2K\u001b[0G\u001b[31m✘ Error:\u001b[0m An error occurred while executing the script:', error.message); 
  process.exit(1);
}
